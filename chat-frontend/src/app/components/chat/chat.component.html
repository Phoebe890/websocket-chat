<div class="chat-container">
  <div class="header">
    <h2>AI Assistant (Powered by Gemini)</h2>
  </div>

  <!-- #messageArea is a template reference variable that gives us access to this div in our component code. -->
  <ul #messageArea class="message-area">
    <!-- Loop over the messages array and display each one -->
    <li *ngFor="let msg of messages" class="message-wrapper">
      <!-- Use ngClass to dynamically apply CSS classes based on the sender's name -->
      <div class="message" [ngClass]="{'user-message': msg.sender === 'User', 'ai-message': msg.sender !== 'User'}">
        <span class="sender">{{ msg.sender }}</span>
        <p class="content">{{ msg.content }}</p>
      </div>
    </li>
    
    <!-- This block shows a "typing" indicator only when we are waiting for a response. -->
    <li *ngIf="isWaitingForAI" class="message-wrapper">
        <div class="message ai-message typing-indicator">
            <span class="sender">Gemini AI</span>
            <div class="dots">
                <span></span><span></span><span></span>
            </div>
        </div>
    </li>
  </ul>

  <!-- The form for sending messages. The button is disabled while the AI is processing. -->
  <form class="message-form" (ngSubmit)="sendMessage()">
    <input 
      [(ngModel)]="messageContent" 
      name="messageContent" 
      placeholder="Ask the AI anything..." 
      autocomplete="off"
      (keyup.enter)="sendMessage()"
    />
    <button type="submit" [disabled]="isWaitingForAI || !messageContent.trim()">Send</button>
  </form>
</div>